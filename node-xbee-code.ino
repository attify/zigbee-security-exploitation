
#include <dht.h> //Library for DHT11  Humidity
#define dht_dpin A0 // DTH11 Data pin connected to AO of arduino
#define led 2 // Led connected to Pin D2
#define ldr A1 // LDR connected to Pin A1
dht DHT; // Creating DHT function 
void setup() {
  // initialize serial:
  Serial.begin(2400); // Initiliaze Hardware serial for xbee
  pinMode(2, OUTPUT); // Pin direction of LED to Output as it sends current

}

void loop() { // Continous loop
  // if there's any serial available, read it:
   DHT.read11(dht_dpin); // Reading DHT11 using the library
  int lig = analogRead(ldr); // Reading analog values from LDR
  int ligp = map(lig, 0, 1023, 0, 100); // Mapping the 10bit resolution ADC to 0 to 100
  int h = DHT.humidity; // Humidity value
  int t = DHT.temperature; // Temperature value

  while (Serial.available() > 0) { // Checking for any data on Xbee
    int red = Serial.parseInt(); // look for the next valid integer in the incoming serial stream
    if (Serial.read() == '!') // Check if the next Serial data is '!'
    {
      if(red == 1) // if the recieved data is 1! 
        {
        Serial.print(h,DEC); // Send humidity value with '!'
        Serial.print("!");

          }
         else 
         if(red == 2) // if the recieved data is 2!
    {
      Serial.print(t,DEC); // Send Temperature value with '!'
      Serial.print("!");

    }
    else 
    if(red == 3) // if the recieved data is 3!
    {

    Serial.print(ligp,DEC); // Send Light value with '!'
      Serial.print("!");

    }
     else 
     if(red == 4) // if the recieved data is 4!
    {
   digitalWrite(2, HIGH); // Turn ON the LED
    delay(100);
    
    }
    else if(red == 5)  // if the recieved data is 5!
    {
   digitalWrite(2, LOW);  //Turn OFF the LEd
    delay(100);
    Serial.print("!attify!"); // Send the AES key
     
    }
    }
  }
}








